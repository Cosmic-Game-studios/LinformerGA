@push('scripts')
<script>
document.addEventListener('DOMContentLoaded', () => {

    /* ────────── Bootstrap-Tooltips ────────── */
    document.querySelectorAll('[data-bs-toggle="tooltip"]')
        .forEach(el => new bootstrap.Tooltip(el));

    /* ────────── Seiteneinstellungen (Datum / Zeilen) ────────── */
    const urlParams = () => new URLSearchParams(location.search);

    document.getElementById('dateSelect').addEventListener('change', e => {
        const p = urlParams();
        p.set('date', e.target.value);
        p.delete('page');
        location.search = p.toString();
    });

    document.getElementById('perPageSelect').addEventListener('change', e => {
        const p = urlParams();
        p.set('per_page', e.target.value);
        p.delete('page');
        location.search = p.toString();
    });

    /* ────────── Live-Filter (Level + Volltext) ────────── */
    let currentLevel = 'all';
    let currentSearch = '';

    const applyFilters = () => {
        const term = currentSearch.toLowerCase();
        document.querySelectorAll('#logTable tr').forEach(tr => {
            const lvl   = tr.dataset.level;
            const text  = tr.innerText.toLowerCase();
            const okLvl = currentLevel === 'all' || lvl === currentLevel;
            const okTxt = !term || text.includes(term);
            tr.classList.toggle('d-none', !(okLvl && okTxt));
        });
    };

    /* Level-Buttons */
    document.querySelectorAll('.level-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentLevel = btn.dataset.level;
            applyFilters();
        });
    });

    /* Volltextsuche */
    document.getElementById('searchInput').addEventListener('input', e => {
        currentSearch = e.target.value;
        applyFilters();
    });

    /* ────────── Auto-Scroll zum Anfang ────────── */
    const box = document.querySelector('.card-body');
    if (box) box.scrollTop = 0;
});
</script>
@endpush